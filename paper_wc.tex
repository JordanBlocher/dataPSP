\documentclass[12pt]{article}
 
\usepackage[text={6in,8.1in},centering]{geometry}

\usepackage{enumerate}
\usepackage{amsmath,amsthm,amssymb}
\usepackage{mathrsfs} % to use mathscr fonts

\usepackage{multicol}
\usepackage{url}

\usepackage{epstopdf}
\usepackage{caption,subcaption}
\usepackage{pstricks}
\usepackage{pst-solides3d}
\usepackage{pstricks-add}
\usepackage{graphicx}
\usepackage{pst-tree}
\usepackage{pst-poly}
\usepackage{calc,ifthen}
\usepackage{float}\usepackage{multicol}
\usepackage{multirow}
\usepackage{array}
\usepackage{longtable}
\usepackage{fancyhdr}
\usepackage{algorithmicx}
\usepackage[noend]{algpseudocode}
\usepackage{changepage}
\usepackage{color}
\usepackage{listings}
\usepackage{fancyvrb}
\usepackage{verbatim,moreverb}
\usepackage{courier}
\usepackage{algorithm}

\lstset{ %
language=C++,               
basicstyle=\footnotesize,
numbers=left,                  
numberstyle=\tiny,     
stepnumber=1,         
numbersep=5pt,         
backgroundcolor=\color{white},  
showspaces=false,               
showstringspaces=false,         
showtabs=false,                 
columns=fullflexible,
frame=single,          
tabsize=2,          
captionpos=b,       
extendedchars=true,
xleftmargin=17pt,
framexleftmargin=17pt,
framexrightmargin=17pt,
framexbottommargin=4pt,
breaklines=true,       
breakatwhitespace=false, 
escapeinside={\%*}{*)}       
}

\newenvironment{block}{\begin{adjustwidth}{1.5cm}{1.5cm}\noindent}{\end{adjustwidth}}

\newtheorem{proposition}{Proposition}[section]
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{corollary}{Corollary}[section]
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

 
\def\verbatimtabsize{4\relax}
\def\listingoffset{1em}
\def\listinglabel#1{\llap{\tiny\it\the#1}\hskip\listingoffset\relax}
\def\mylisting#1{{\fontsize{10}{11}\selectfont \listinginput[1]{1}{#1}}}
\def\myoutput#1{{\fontsize{9}{9.2}\selectfont\verbatimtabinput{#1}}}

\newcommand{\vs}{\varsigma}
\newcommand{\mcL}{\mathcal{L}}
\newcommand{\mcI}{\mathcal{I}}
\newcommand{\g}{\sigma}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
 
\headsep25pt\headheight20pt
 
 
\pagestyle{fancyplain}
\rhead{\fancyplain{}{\small\bfseries Blocher, Jordan}}
\cfoot{\ \hfill\tiny\sl Draft printed on \today}
 
 
\setlength{\extrarowheight}{2.5pt} % defines the extra space in tables
 
\begin{document}
\begin{multicols}{2}

\section{Abstract}

We investigate the 2cm app, a data-exchange platform published for China Mobile Hong
Kong 4G Pro Service Plan customers. Telecommunications ISPs' revenue is typically
gained by charging users a fixed fee for a maximum amount
of data usage in a month, i.e., a monthly data cap \cite{???}. 
2cm's (2nd exchange market) data exchange platform allows users to submit
bids to buy and sell data.
This usage model, is, as far as our knowledge, the first data trading
platform that allows customers to buy and sell their own data.
We describe a distributed auction mechanism for data exchange inspired by the
classic PSP throughput problem,
and prove that our distributed data exchange mechanism provides incentive
compatibility (social choice function), and that we have efficiency
using only partial valuation information of each participant in an exchange market.

In applying a distributed PSP implementation to CMHK market, we
find that
the market is able to achieve an equilibrium as the sellers and buyers have an
incentive for a collaborative exchange, and design our mechanism tp provide the functions
for effective communication between the connected users. We claim that in
this secondary market our formulation holds the desired VCG qualities through the construction of a
probable equilibrium \cite{???}. We further provide bounds on the auction duration, 
with respect to the classic throughput problem.
and provide simulated results on convergence time to support our (FIND
COMPETITVE RATIO!), and a bound
on the convergence of our mechanism. We extend the works of cite!cite!
i.e. (market influence/EQ,social EQ,payment/allocation models) OR (bandwidth, data bundles, distributed
market algorithms) and show the existence of a dynamic global market equilibrium, allowing for a unique set of market dynamics.



\section{Introduction}

In this work, we propose \emph{a distributed progressive second price (PSP) auction in
order to maximize social utility in the CMHK market}. Using the
distributed PSP mechanism on CMHKs data
exhange platform, we show that for cellular data allocated between multiple users there
exists an $\epsilon$-Nash market equilibria. A quality of the PSP auction is that
demand information is not known centrally, rather, it is distributed in the
buyers' valuations. The mechanism for an auction is defined
as \emph{distributed} when the allocations at any element depend only on
\emph{local} state: the quantity offered by the seller at that element, and the
bids for that element only \cite{lazar}. In this work, the proposed mechanism
allows the distribution of bids, where there are many ISPs each holding
thier own local auction; there is no entity that holds a global market knowledge.

In a PSP mechanism, bids consist of (i) an available (required) quantity and (ii) a unit-price (calculated
using its own demand functions). Buyers submit bids cyclically until an
($\epsilon$-Nash) equilibrium is reached and a local auction is concluded. 

(FEE IS FIXED OR
PER-UNIT?)(HOW DO WE MODEL ISP REVENUE? IMMEDIATE FUTURE)

The form of the auction mechanism presented here is (CAN BE? NEED TO SHOW TO
CLAIM 'IS') described as a \emph{locally}
pure-strategy progressive game with incomplete, but perfect information.
 you have perfect information, since you know what each move of the opponent is.
However, since you do not know the payoff function of the other player (which
will affect its behavior even if it does not alter your own victory conditions),
it is a game of incomplete information.
In the overall market analysis assumes complete, but perfect information.
 
 (WHAT
DOES NASH SAY ABOUT THIS?) (TRY MIXED? CAN ONLY HAVE MIXED WITH A DISTRIBUTED
VALUATION.. FUTURE WORK) 

The paper is organized as follows...

(MOVED: TO ORGANIZE)\\
The main contribution of this work 
is an auction mechanism inspired by the classic PSP throughput problem. In
order to apply a distributed PSP implementation to the CMHK market,
we analize the behavior of users in a dynamical data exchange market. As both buyers and sellers are able
to change their bid strategies, and as each user only has \emph{local}
information about the bidding environment, it is clear that an unconstrained
market, even with a finite number of users, could suffer from the communication
expense from numerous local auctions trading an infinitely divisible resource.
We will assume that the cost of participating in the CMHK secondary market is
absorbed by the bid fee, which could represent data used in submitting bids, or
a fee charged per unit of data, or a flat rate charged at the completion of the
purchase. It is worth mentioning that CMHK users are not allowed to resell data
purchased from the CMHK
market, additionally, the purchased data does not carry to the next
service period. Therefore, a market equilibrium, where
supply equals demand, requires that users maintain incentive for truthfullness
across a distributed setting.
We complete a comprehensive analysis of market dynamics, (FINISH)
To the best of our knowledge, this is the first work to provide a truthful
mechanism in a distributed setting for data-exchange based on market behavior.
\\
\textbf{Remark:} It is certainly possible to extend the mechanism, alleviating the
restrictions introduced by the CMHK secondary market. We reserve this for
future work.

We claim that the CMHK market is
able to achieve an equilibrium as the sellers and buyers have an
incentive for a collaborative exchange, and as our mechanism provides
for effective communication between the connected users. 

Despite the small message space, with many user types, there is no single
way to do the transformation from the direct revelation mechanism to the
desired one. Our mechanism is naturally designed by guessing
right direct-revelation-to-desired-mechanism transformation and building it
into the allocation rule to be the primary step in the design. This incentive for a user to
truthfully reveal its type is built into the user strategies. As in classic
mechanism design, we determine the equilibria as result of incentive
compatibility in our mechanism design. 
We claim that in the CMHK market our formulation not only holds the desired VCG qualities,
but minimizes comminication overhead 
and auction duration, resulting in a convergence time (FIND COMPETITIVE RATIO?)
with respect to the classic throughput problem. 


This is the (built-in) transformation from the
direct-revelation mechanism to the desired message space.

\subsection{Distributed Progressive Second Price Auctions}

Progressive second price auctions (PSPs) were proposed
in \cite{lazar}, \cite{diffserve} to provide a dynamic network service pricing
scheme to provide consistent services for network bandwith users.
\cite{diffserve} conducts a game theoretic analysis, deriving
optimal strategies for buyers and brokers, and further shows the existence
of networkwide market equilibria based on their game-theoretic
model. Constructing necessary and sufficient conditions for the stability
of the game allows the sustainability of any set
of service level agreement configurations between Internet service
providers.

We begin with a brief introduction to the distributed PSP auction for bandwith
sharing, first introduced by Lazar and Semret \cite{lazar}.
We define a set of $\mcI = \lbrace 1,\cdots,I\rbrace$ network bandwidth users.
Suppose each user $i \in \mcI$ makes a bid $s_i^j = (p_i^j, d_i^j)$ to the
seller of resource $j$, where $p_i^j$ is the unit-price the user is willing to
pay and $d_i^j$ is the quantity the user desires. The \emph{bidding profile} forms a grid, $s \equiv
[s_i^j] \in \mcI \times \mcI$, and $s_{-i} \equiv [s_1^j , \cdots , s_{i-1}^j , s_{i+1}^j , \cdots
, s_I^j]_{j\in\mcI}$ is the profile of user $i$'s opponents. 
Using this classic PSP mechanism, \cite{lazar} shows that given the opponents
bids $s_{-i}$,
user $i$'s $\epsilon$-best response to seller $j$ is $s_i^j = (w_i^j, v_i^j)$
and is a Nash move
where $\epsilon > 0$ is the bid fee, $B_i =\sum_{j\in\mcI} b_i^j$ is user $i$'s
budget, and every user has an elastic demand function.
Based on the profile of bids $s^j = [s^j_1, \cdots , s^j_I]$, the seller applies
an allocation rule $a(s^j) = [a_1^j, \cdots , a_I^j]$, where $a^j_i$ is the quantity allocated
by $j$ to each user $i\in\mcI$ and $c^j_i$ is the cost charged to $i$ for
allocations awarded in auction $j$. 
An allocation is considered feasible if $a^j_i \le d_i^j$, and $c^j_i \le  p^j_i d_i^j$.

% MECHANISM
\subsubsection{The PSP Mechanism}\label{mechanism}
The PSP auction as given in \cite{lazar} and \cite{semret} is designed for the
problem of network bandwidth allocation, and is analyzed as a noncooperative
game where $i\in\mcI$ agents buy the
fixed amount of bandwidth $d_i^j$ from sellers $j\in\mcI$.
The market price function (MPF) for a buyer-seller pair is,
% NEW MARKET PRICE
\begin{align}\label{dataprice}
\begin{split}
    P_i^j(z, s_{-i})= \inf\bigg\lbrace y\ge 0 : D_i^j(y, s_{-i}) \ge z \bigg\rbrace,\\
\end{split}
\end{align}
and is the of minimum prices a user bids in
order to obtain bandwidth $z$ given opponent profile $s_{-i}$. 
The maximum available quantity of data in auction
$j$ at unit price $y$ given $s_{-i}^j$ is,
% NEW INVERSE DEMAND
\begin{align}\label{datapriceinverse}
\begin{split}
    D_i^j(y, s_{-i}) &= \bigg[ D^j - \sum_{p_k^j>y,k\ne i} d_k^j  \bigg]^+,
\end{split}
\end{align}
where $D^j$ is the total amount of bandwith that user $j$ has to offer.
% DATA ALLOCATION RULE
For each $i \in \mcI$, the allocation from auction $j$ is,
% and so for profile $s_i$, for any $i \in \mcI$,
\begin{align}\label{dataallocation}
    a_i^j(s) &= \min\bigg( d_i^j, 
    D_i^j(p_i^j,s_{-i}^j)\bigg).
\end{align}
Finally, we have the cost of the allocation,
% DATA COST
\begin{align}\label{datacost}
    c_i^j(s) = \displaystyle\sum_{k\ne i} 
p_k^j \big[a_k^j(0; s_{-i}^j)
    -a_k^j(s_i^j;s_{-i}^j)\big].
\end{align}

It was shown, in \cite{lazar}, that the mechanism may converge to a Nash market
equilibria for differentiated services
allocated between multiple agents when all players bid their real marginal valuation
of the bandwidth resource. In other words, the PSP constraints are
sufficient to attain the desirable property of truthfullness through incentive
compatibility. The pricing mechanism upholds the \emph{exclusion-compensation
principle}, user $i$
pays for its allocation so as to exactly cover the ``social opportunity cost"
which is given by the declared willingness to pay (bids) of the users who are
excluded by $i$'s presence, and thus also compensates the seller for the maximum lost potential
revenue \cite{lazar}.
The PSP rules assume that an agent's valuation is represented by an elastic valuation function.
\definition{\cite{lazar}}
A real valued function, $\theta(\cdot): [0,\infty) \rightarrow [0,\infty)$, is an \emph{(elastic) valuation
function} on $[0, D]$ if 
\begin{itemize}
    \item $\theta(0) = 0$,
    \item $\theta$ is differentiable,
    \item ${\theta}' \ge 0$, and ${\theta_i}'$ is non-increasing and continuous,
     \item There exists $\gamma > 0$, such that for all $z \in [0,D]$,
${\theta}'(z) > 0$ implies that for all $\eta \in [0, z), {\theta}'(z) \le
{\theta}'(\eta)
- \gamma(z - \eta)$. 
\end{itemize}
The function $\theta'(\cdot)$ on $[0, D]$ is called an (elastic) demand
function.
In the PSP market, a
user is considered truthful if their bid price equals their marginal valuation,
i.e. $p_i^j = {\theta_i^j}'$.


\section{Related Work}

\section{The Problem Model}


\subsection{The CMHK Market}

We construct the model for a PSP data auction for mobile users
particpating in CMHK's secondary data-sharing market.
Define $\mcI = \lbrace 1, \cdots, I\rbrace$ as the set of users who purchase or sell
data from other users. We again define the bidding profile for any user to be 
$s \equiv
[s_i^j] \in \mcI \times \mcI$, and $s_{-i} \equiv [s_1^j , \cdots , s_{i-1}^j , s_{i+1}^j , \cdots
, s_I^j]_{j\in\mcI}$ as the profile of user $i$'s opponents. 
As a cellular network is fully connected, we assume that a buyer submits bids directly to sellers via the
cellular network. We assume that users are selfish, and therefore
rational. 
Users prefer to participate in the CMHK secondary market as it allows them to purchase
additional data for a cost less than the overage fee set by the ISP. 
Thus we assume that all users submit bids in order to maximize their
(private) valuation functions. 
In general, user preferences are defined by a utility function, $u$, which 
represents a users' valuation of an allocation minus the price.
Absent the cost or revenue from trading data, CMHK users gain utility from consuming
data. 
We assume that data is a unary resource belonging to the seller, and
therefore we identify each local auction with the identity of the seller
$j\in\mcI$.
We further show that user valuation satisfies the conditions for an
\emph{elastic demand function}, as in \cite{lazar}.
Finally, we assume in the CMHK market that a buyers' budget is always
sufficient, as the alternative is to pay the overage fee to the ISP.

The CMHK market does not allow for brokers \cite{cmhk}, we thereby determine that
the bid profiles must adhere to some additional restrictions, which we will
imply using the PSP bid profile notation. In other words, we assume that buyers and sellers are
separated (a seller does not also buy data and vice versa). Thus, we may assume
that this is implied in our notation.
A user's identity $i \in \mcI$ as a \textbf{subscript} indicates that the bid
belongs to a \textbf{buyer}, and a \textbf{superscript}, $j\in\mcI$, indicates
the bid belongs to a \textbf{seller}.
Suppose $i$ is buying from $j$. The bid is represented by $s_i^j = (d_i^j, p_i^j)$, 
meaning $i$ would like to buy from $j$ a quantity $d^j_i$ and is willing to pay
a unit price $p^j_i$. Without loss of generality, we assume that all users bid in all
auctions; if a user $i$ does not submit a bid to $j$, or vice versa, we simply set $s_i^j =
(0,0)$. Naturally, in a live auction, if a buyer does
not submit a bid to a seller, then this implies $s_i^j = 0$ for both buyer $i$
and seller $j$. Obviously, a buyer that does not submit a bid will not recieve opponent profiles from seller
$j$. We additionally determine that a user who does not submit a bid is holding
its previous bid, either zero or nonzero. For the purposes of our analysis, we will assume that a zero bid from a
buyer is equivalent to no bid.
A seller $j$ submits a bid $s_i^j = (d_i^j, p_i^j)$ to the secondary market,
with the intent of offering a
quantity $d_i^j \in d^j = [d_i^j]_{i\in\mcI}$ 
with reserve unit price $p_i^j \in p^j = [p_i^j]_{i\in\mcI}$ to buyer $i$. We emphasize that we allow for $s_i^j$ to
stand for a buyer or sellers' bid, the \emph{direction} of the bid (vector) is determined
by the user type, whether or not they are  a buyer or a seller. 
To further clarify our analysis, we will emphasize the separation of buyers and
sellers using
$s_i$ and $s^j$, indicating if a bid is from a buyer or a seller.
In other words, a bid $s^j =
[s_i^j]_{j\in\mcI}$ is understood as an offer of data by seller $j$ in the CMHK
secondary market. The notational conventions of the bid vectors are essentially 
slices of the grid, $s^j = [s_i^j]_{i\in\mcI}$ denotes a sellers' profile, and $s_i =
[s_i^j]_{j\in\mcI}$ denotes a buyers' profile. 
Furthermore, noting that this is a simplification for ease of notation, we let $D^j = \sum_{i\in\mcI}
d_i^j$ be the total amount of data $j$ has to sell, and $D_i = \sum_{j\in\mcI}
d_i^j$ represent the
total amount of data requested by buyer $i$. 

Consider the grid of bid proiles, $s$, representing the distributed PSP auction
mechanism in the CMHK market, each buyer $i$ will
have information from each seller $j$, as well as opponent profiles $s_{-i}$
from each auction in which it is participating, and therefore
in the extreme case, where $i$ submits bids to all auctions $j\in\mcI$, buyer
$i$ gains access to the full grid $s$. However, 
sellers can only gain information about the market grid by observing buyer
behavior in their local auction.
In our current formulation, we do not allow a seller to host multiple
auctions(FUTURE WORK?). Thus, the buyers are able to directly and globally
influence the CMHK market dynamics, with the sellers taking a secondary role
(FIND IN ANOTHER PAPER FOR SUPPORT OR OBVIOUS ENOUGH?).



\subsection{User Valuation}

We assume that the CMHK market does not have network
bottlenecks, which is purely a bandwidth problem, as in \cite{semret}, and as
bandwidth in wireless networks is not the focus of this paper. We
conduct a comprehensive analysis, deriving a globally optimal strategy suited for
users with local information in a distrubuted data-sharing model. 
Users in the CMHK market do not need to bid on a complete ``route", as in the
bandwidth allocation problem \cite{semret}. Instead, our mechanism allows a buyer
to \emph{opt-out} of auctions by submitting zero bids. This strategy maximizes
utility while minimizing the number of positive bids submitted to the overall
market. We define an \textbf{opt-out function}, associated with a buyer $i$ as
part of its type. Buyer $i$, when determining how to aquire a possible allocation $a$,
will determine its bid quanities by,
\begin{equation}\label{opt-out}
    \g_i(a) = [\g_i^j(a)]_{j\in\mcI}.
\end{equation}
In a general sense, this abstraction applies our \emph{user strategy}
to the PSP rules.
% OPT-OUT BUYER
We define each buyer as a user $i\in\mcI$ with quasi-linear utility
function $u_i = [u_i^j]_{j\in\mcI}$, a buyers' utility function is now of the form,
\begin{equation}\label{buyerutility}
    u_i = \theta_i \circ \g_i(a) - c_i,
\end{equation}
where the composition of the elastic valuation function $\theta_i$ with $e_i$ acts as a distribution function, splitting
the buyers' valuation of allocation $a$ across local markets (and thus multiple sellers).
In this way we extend the PSP rules described
in \cite{semret} to design equilibria across subsets of local data-exchange markets.

The sellers, $j\in\mcI$ are not associated with an opt-out function, we
consider their valuation to be a functional extension of the buyers, where
$\theta^j$ is constructed by buyer demand.
The sellers strategy can only be to determine the reserve price of their local
auction, using only information from buyers who have not opted out.
In our analysis, we demonstrate market dynamics, and further show evidence of symmetry in the strategies of
buyers and sellers.

\subsubsection{Valuation under Market Dynamics}
The buyer demand largely motivates the market price function, however, the
distributed nature of the market prevents any single user from knowing the
market demand for a quantity of data. All users have knowledge of market
supply, as this is public information, however only buyers
are able to determine supply or demand across multiple auctions after time $t=0$, and then only from auctions
in which they participate. \\
\textbf{Remark:}
It is possible that a seller would be able to derive information about other
auctions by examining buyer bids over time, particularly if the seller had knowledge of the
buyer strategy. (FUTURE WORK?)\\
In order to represent the public platform of the secondary market, we model the ISP as
a kind of buyer $\kappa$ who remains at time $t=0$, i.e. does not participate
in any auctions. At time $t=0$, a seller $k$ entering the market will have submitted bid
$s_\kappa^j =(\epsilon, D^j)$ to the CMHK platform. A buyer entering the market
at $t=0$ is assumed to have an initial nonzero bid price, which we may assume
(SAY BETTER!) is initialized as 
an independently and identically distributed (i.i.d.) random variable $p_i^j=X$ with
probability $\mathcal{P}$,
$$
    \mathcal{P}[\epsilon\le X \le \kappa] =
\displaystyle\int_\epsilon^{p^\kappa} \mathfrak{f}(x) \
ds,
$$
where $p^\kappa$ is the overage charge of the ISP, and $\mathfrak{f}$ the probability
density function of $X$.
%may represent by some homogenous function of degree one (EXPAND?). 
Thus the auction
begins at time $t>0$, and at $t=0$, $j$ will increment through a single iteration,
initializing bid prices.

A given demand may lead to diffent prices, which emerge directly from the users valuation
of the resources and their decision strategies. The seller does not
require a priori demand information.
It is worth mentioning that the \emph{analysis} of the auction as
a game assumes some forms of demand and supply, in order to derive properties.
The mechanism itself does not require any knowledge of user demand or
valuation. 
\iffalse
The ISP overage
charge inducing an upper bound on the sellers' reserve prices implies that
supply will always be greater than demand, thereby reducing the sellers'
influence on market dynamics.
\fi

As the buyer valuation is elastic, even infinitesimal changes in the market dynamics can be
modeled. This, and the homogenous nature of data in the CMHK market, 
allows for the analysis of additional constraints imposed by the user
strategies. Thus our motivation to begin our analysis with buyer valuation $\theta_i$.
A buyers' valuation of an amount of data represents how much a buyer is willing
to pay for that amount. 
This is equivalent to the bid price that
satisfies $\theta_i$ given a fixed amount of data. We determine the
buyers' utility-maximizing bid given quantity $z\ge0$ to be a mapping to the lowest
possible unit price. We have,
% BUYER PRICING 
\begin{equation}\label{buyerinversedemand}
    f_i(z) \triangleq \inf\big\lbrace y\ge 0:
        \rho_i(y) \ge z, \ \forall \ j \in \mcI\big\rbrace,
\end{equation}
where $\rho_i(y)$ represents the demand function of buyer $i$ at bid price
$y\ge 0$, and gives the quantity that buyer $i$ would buy at a given price.
We determine that the market supply function is equivalent to buyer demand, and 
acts as an ``inverse" function of $f_i$. We have, for bid price $y\ge 0$,
% BUYER DEMAND 
\begin{equation}\label{datasupply}
    \rho_i(y) = \sum_{j\in\mcI : p_i^j\ge y} D^j.
\end{equation}
We note that $f_i$ is such that
$i$ could still bid in \emph{any} auction $j\in\mcI$.
Therefore, in a coordinated bid, the utility-maximizing bid price is the
lowest unit cost of the buyer to participate in all auctions, and corresponds to
the maximum reserve price amongst the sellers. We will later show, in Proposition
\ref{buyercoordinate}, that a buyer does not lose utility from coordinating its
bids, i.e. using the same bid for all auctions.
Using buyer bid quantity $\g_i^j(a)$, from (\ref{opt-out}), 
we have the following Lemma,
{
% BUYER CONSTRAINTS
\lemma{(Buyer constraints)}\label{buyerconstraints}
Let $i\in\mcI$ be a buyer with bid, $s_i = (\g_i(a), p_i)$, which must obey
the following constraints,
\begin{equation}\label{buyercapmax}
    \sum_{j\in\mcI} \g^j_i(a) \le D_i,
\end{equation}
and, as $i$ is rational, and therefore utility-maximizing, $i$ must have
sufficient bids $s_i^j > 0$ so that,
\begin{equation}\label{buyercapmin}
    \sum_{j\in\mcI} d^j_i \ge D_i,
\end{equation}
where $d_i^j$ denotes the bid quantity of seller $j$.
}\\
\textbf{Proof:}
A rational buyer does not want to purchase extra data, as this would be
equivalent to overpaying, and so (\ref{buyercapmax}) holds. We also assume that
$i$ wants to fufill their data requirement, and so (\ref{buyercapmin}) implies
that $i$ submits positive bids to a set of buyers that will be able to fufill
their demand.

The seller is similarly represented, however a seller only has
information from buyers in its own auction, and may only be indirectly influenced by
buyers in other auctions. So from the perspective of the
seller we have a more direct interpretation of valuation as revenue.
We determine the demand function of seller $j$ at reserve price $y\ge 0$ to be,
% BUYER DEMAND 
\begin{equation}\label{datademand}
    \rho^j(y) = \sum_{i\in\mcI : p_i^j\ge y} \g_i^j(a), 
\end{equation}
and define the ``inverse" of the buyer demand function for seller $j$ as
potential revenue at unit price $y$, we have, 
% SELLER REVENUE 
\begin{equation}\label{sellerinversedemand}
    f^j(z) \triangleq \sup\big\lbrace y\ge 0:
        \rho^j(y) \ge z, \ \forall \ i \in \mcI\big\rbrace,
\end{equation}
and, unsurprisingly, $f^j$ maps quantity $z$ to the highest possible unit data
price. Now, we determine that, in addition to some natural constraints, the sellers' highest
``possible" price is conditioned by
additional restrictions on its pricing function, the motivation for which is
that a buyer has the choice to opt-out of any auction, and so seller $j$ has an
incentive to set its reserve price to sell the maximum amount of
data. Thus we have the following Lemma,
{
% SELLER CONSTRAINTS
\lemma{(Seller constraints)}\label{sellerconstraints}
Let $j\in\mcI$ be a seller with bid $s^j$, then $j$ must obey the following constraints.
A bid $s_i^j= (d_i^j, p_i^j)$, to buyer $i$ must be such that,
\begin{equation}\label{datacapmax}
    \sum_{i\in\mcI} d^j_i \le D^j,
\end{equation}
In addition, for a rational seller, the reserve price must
satisfy, $\forall \ i\in \mcI$,
\begin{equation}\label{reservepricemin}
   p_i^j \ge \min_{i\in\mcI}\big(p_i^j),
\end{equation}
and,
\begin{equation}\label{reservepricemax}
   p_i^j \le \max_{i\in\mcI}\big(p_i^j).
\end{equation}
Finally, as $j$ is rational, $j$ must submit enough bids $s_i^j >0$ so that,
\begin{equation}\label{datacapmin}
    \displaystyle\sum_{i\in\mcI} \g_i^j(a) \ge D^j.
\end{equation}
}\\
\textbf{Proof:}
The first statement is obvious, 
a seller cannot sell more data than they have,
Then, (\ref{reservepricemin})
follows from the assumption that $j$ is rational, and so utility-maximization
acts as revenue maximization, a rational seller will not sell its
data at a price less than the lowest offer. Finally, as a rational seller will
attempt to maximize profit, and will try and sell all of its data, and so we
must have sufficient demand
from the buyers. Therefore, (\ref{reservepricemax}) and (\ref{datacapmin}) hold. Together, (\ref{datacapmax}) and
(\ref{datacapmin}) address the case where $\sum_{i\in\mcI} \g_i^j(a) >  D^j$. In
this case, by (\ref{dataallocation}), $j$ may submit a partial bid to a buyer
$i$ so that $\sum_{i\in\mcI} d^j_i = D^j$.

We proceed to determine the properties and characteristics of the user valuation functions. Buyer $i$'s valuation is interpreted as a unit valuation $\theta_i$,
distributed across the CMHK market via bids in local auctions. 
As such, buyer behavior is influenced by opponent bid profiles from multiple auctions.
We therefore determine that the valuation of any user must be modeled as a function of the entire
marketplace. Naturally, a buyers' valuation is aggragated over local markets, and the
sellers' valuation is aggragated over its own auction. We model the valuation of
users based on the opt-out user behavior, thereby including the buyers'
influence on the market. We have already introduced the composition $\theta_i
\circ \g_i$ as the valuation of the buyers. We further model the valuation of the sellers, based on
(\ref{datademand}) and (\ref{sellerinversedemand}). We first note that, in
general (and so we omit the subscript/superscript notation), the valuation of data quantity $x\ge 0$ is given by,
$$
    \theta(x) = \int_0^x f(z) \ dz,
$$ 
as in \cite{semret}. Now, we have the following Lemma,
{
\lemma{(User valuation)}\label{uservaluation}
For any buyer $i\in\mcI$, the valuation of a potential
allocation $a$ is, 
\begin{equation}\label{buyervaluation}
    \theta_i \circ \g_i(a) = \displaystyle\sum_{j\in\mcI}
 \int_0^{\g_i^j(a)} f_i(z) \ dz.
\end{equation}
Now, we may define seller $j$'s valuation in terms of revenue,
\begin{equation}\label{sellervaluation}
    \theta^j= \displaystyle\sum_{i\in\mcI} \theta^j \circ \g_i^j(a) = \sum_{i\in\mcI}
 \int_0^{\g_i^j(a)} f^j(z) \ dz.
\end{equation}
We have that $\theta_i$ and $\theta^j$ are elastic valuation functions, with
derivatives
${\theta_i}$ and ${\theta^j}'$ satisfing the conditions of elastic demand.
}
\textbf{Proof:} 
Let $\xi$
be a unit of data from buyer bid quantity $\g_i^j(a)$.
If $\xi$ decreases by incremental amount $x$, then seller bid $d_i^j$ must
similarly decrease. The lost potential revenue for seller $j$ is the price of
the unit times the quantity decreased, by definition, $f^j(\xi)x$, and so,
$$
    \theta^j(\xi) - \theta^j(\xi-x) = f^j(\xi)x.
$$
Thus (\ref{sellervaluation}) holds.
As we may use the same argument for (\ref{buyervaluation}), as such, we will
denote $f_i=f^j=f$ for the remainder of the proof. We observe that the function
$f$ is the first
derivative of the valuation function with respect to
quantity. Letting $\theta_i=\theta^j=\theta$, the existence of the derivative implies $\theta$ 
is continuous, and therefore, in this context, $f$ represents
the marginal valuation of the user, ${\theta}'$. Also, clearly
$\theta(0)=\theta(\sigma(0)) = 0$. Now, as we consider data to be an infinitely
divisible resource, we have a continuous interval between allocations $a$ and
$b$, where $a\le b$. Now, as $\theta$ is continuous, for some $c\in[a,b]$, 
$$
\theta'(c) = \lim_{x\to c}\frac{\theta(x) - \theta(c)}{x-c} = f(c),
$$
and so $f=\theta'$ is continuous at $c\in[a,b]$, and so as $a\ge 0$, 
$\theta'\ge 0$. Finally, we have that concavity follows from the demand
function. Then, as $\theta'$ is
non-increasing, we may denote its derivative $\gamma \le 0$,
and taking the derivative of the Taylor approximation, we have, $\theta'(z) \le
\theta'(\eta) + \gamma(z-\eta)$.

We assume that a buyer wants to minimize the cost of purchasing their data
requirement, at the same time ensuring they get the full allocation $\g_i(a)$,
and so must minimally meet $j$'s reserve price. 
A seller will try to maximize profit, 
and so will try to sell all of its data.  By Lemma
\ref{buyerconstraints} and Lemma \ref{sellerconstraints}, we have,
$d_i^j = \g_i^j(a) \Rightarrow \sum_{i\in{\mcI}} d_i^j =
\sum_{i\in\mcI} \g_i^j(a) = D^j = D_i$. It is worth observing that this result
does \emph{not} imply that $s_i=s^j$. 
Finally, the sellers' natural utility is the potential
profit, or simply $u^j = \theta^j$, where we have chosen to omit the original cost of the data
paid to the ISP, as it is not a component of our mechanism, and as a discussion
of mobile data plans is outside the scope of this paper.  

\subsection{PSP for Data-Exchange}

We intend to show that our auction
is rational and achieves the desired VCG properties, as does the original
formulation. Using \cite{zheng} as a basis for our model, and \cite{lazar} as
realistic, theoretic, and notational templates, we define optimal strategies for
CMHK users, and demonstrate that the development of a set PSP auction mechanisms
in a data exchange setting is able achieve a network equilibrium for cellular data. 


% MECHANISM
\subsubsection{Data Auction Mechanism}\label{datamechanism}
We now proceed to formally define the PSP auction, which determines the actions 
buyers and sellers in the CMHK market, and which we will denote the \emph{data}
PSP rules. The rules presented here incorporate of the opt-out function with the
mechanism as in \cite{lazar}, which we note greatly simplifies our
analysis. 
The market price function (MPF) for a buyer in the CMHK market
can be described as follows:
% NEW MARKET PRICE
\begin{align}\label{dataprice}
\begin{split}
    &\bar{P}_i(z, s_{-i}) =\displaystyle\sum_{j\in\mcI} \ \g_i^j \circ P_i^j(z_i^j,
s_{-i}^j) \\
    &= \sum_{j\in\mcI}\bigg(\inf\bigg\lbrace y\ge 0 : 
    {D_i^j}(y,s_{-i}^j) \ge \g_i^j(z) \bigg\rbrace \bigg),\\
\end{split}
\end{align}
and is interpreted as the aggragate of minimum prices that buyer $i$ bids in
order to obtain
data amount $z$ given opponent profile $s_{-i}$. We note that
the total minimum price for the buyer must be an aggragation of the
\emph{individual} prices of the buyers as it is possible that the reserve prices
of the individual sellers may vary.\\
\textbf{Remark:} We further note that except at points of discontinuity, from
Lemma \ref{uservaluation} we have that $P_i^j(z) = f_i(z)$. \\
%To simplify the notation, we define $z_i^j = d^j / \vs_i^j$ opt-out
%buyer $i$'s bid quantity. 
The maximum available quantity of data in auction
$j$ at unit price $y$ given $s_{-i}^j$ is: 
% NEW ALLOCATION RULE
\begin{align}
\begin{split}\label{datacomposed}
    \bar{D}_i^j(y,s_{-i}^j) &= \g_i^j \circ D_i^j( y,s_{-i}^j)\\
    &= \bigg\lbrack D^j - \sum_{p_k^j> y} \g_k^j(a)\bigg\rbrack^+.
\end{split}
\end{align}
% DATA ALLOCATION RULE
The resulting data allocation rule is a function of the local market
interactions between buyers and sellers over all local auctions, as is composed with $i$'s opt-out value, so that for each $i \in \mcI$, the
allocation from auction $j$ is,
% and so for profile $s_i$, for any $i \in \mcI$,
\begin{align}\label{dataallocation}
\begin{split}
    \bar{a}_i^j(&s) = \g_i^j \circ a_i^j(s) \\
    &= \min\bigg\lbrace \g_i^j(a), 
    \frac{\g_i^j(a)}{\displaystyle\sum_{p_k^j= p_i^j}\g_k^j(a)} 
D_i^j(p_i^j,s_{-i}^j)\bigg\rbrace,
\end{split}
\end{align}
noting that for the full allocation from all auctions we may simply aggregate
over the seller pool.
Finally we must have that the cost to the buyer adheres to the second price
rule for each local auction, with total cost to buyer $i$,
% DATA COST
\begin{align}\label{datacost}
\begin{split}
    \bar{c}_i(s) &= \displaystyle\sum_{j\in\mcI} 
    p_i^j \bigg(\bar{a}_i^j(0; s_{-i}^j)
    -\bar{a}_i^j(s_i^j;s_{-i}^j)\bigg).
\end{split}
\end{align}
\textbf{Remark:} The cost to buyer $i$ adds up the willingness
of all buyers excluded by player $i$ to pay for quantity $\bar{a}_i^j$. i.e.
$$
    c_i^j(s) = \displaystyle\int_0^{\bar{a}_i^j} P_i^j(z, s_{-i}) \ dz.
$$
This is the ``social opportunity cost" of the PSP pricing rule.

The formulation is inspired to the thinnest allocation route for
bandwidth given in \cite{lazar}. We note that if a single seller $j$ can
satisfy $i$'s demand, then
(\ref{buyerutility}) reduces to the original form, defined in
\cite{semret} as ``a simple buyer at a single resource element".

(OWN WORDS!)
The cost function will therefore be a stepwise-linear function, which is
increasing in slope with each new bidder excluded from the market.

\subsection{User Behavior}

\subsubsection{Buyer Strategy}

 
Although it is possible for a seller to fully satisfy a buyer $i$'s demand, it
is also reasonable to expect that a seller may come close to using their
entire data cap, and only sell the fractional overage. In this case, we
determine that some buyers must split their bids among multiple sellers. 
 
We assume that sellers update their bids with the ISP, which is modeled as a
``buyer" $\kappa$. 
A new sellers' bid, $(D^j, \epsilon)$, as well as updated bids, is public
knowledge. Also, we reason that buyers,
in addition to fufilling their data requirement, have incentive to join
multiple auctions in order to compare prices.
Each seller that buyer $i$ adds
to its pool potentially decreases $i$'s bid quantity in all other auctions, and
so each buyer $i\in\mcI$ directly impacts other buyers in auctions where buyers intersect.
Indeed, each auction joined has the potential to decrease the price a buyer
will pay for its data, in exchange for additional messaging overhead, possible
fees, and increased competition from other buyers. This aspect of
a buyers' valuation represents equity, the liabilies from which may be considered work done to find
sellers, monetary fees, or effort of communication from participation, and so
is naturally absorbed by the bid fee as characterized in \cite{semret}.

The buyer strategy bids in auctions with the highest quantities first,
a natural exploitation of the demand curve. A new seller entering the market
with a large quantity of data will be in high demand. This behavior contributes to market price
stability, as seller valuation is determined by buyer demand, the
buyer strategy tends towards equal valuation of all local markets, and therefore
similar prices. Market equilibrium is achieved when each buyer has equal bids in
each auction. Our bidding strategy is inspired by \cite{lazar}, and we also
hold buyers to consistent bids, where buyers sumbit identical bids to a
subset of sellers with the highest offers.
Thus, we determine when rational (utility-maximizing) buyers opt-out of a local auction. 
We propose the following strategy, 
% BUYER STRATEGY
{
\proposition{(Opt-out buyer strategy)}\label{buyerstrategy}
Define any auction duration to be $\tau \in [0,\infty)$. 
Let $i\in\mcI$ be a buyer and fix all other buyers' bids $s_{-i}$ at time
$t>0\in\tau$, and let $a$ be $i$'s desired allocation. 
% OPT-OUT BUYER STRATEGY
Define the composition,
$$
     \g_i^j \circ a = \g_i^j(a) = \frac{a_i^j}{j},
$$
to be the buyer strategy with respect to quantity, and the set,
% MIN SET
$$
    \mcI_i(n) =\argmax_{\mcI' \subset \mcI, \vert\mcI'\vert =
n}\sum_{j\in\mcI'} D^j,
$$
where buyer $i$ chooses its seller pool by determining $n$, for $j\in\mcI_i$,
\begin{equation}\label{buyercoordinate}
    \min\big\lbrace n \in \mcI \ \vert \ n D^n\ge D_i\big\rbrace. 
\end{equation} 
The buyer strategy produces a minimal subset of sellers $\in \mcI$ 
able to satisfy buyer $i$'s demand. For 
fixed $n$ we will denote this subset,
\begin{equation}\label{sellers}
    \mcI_i \subset \mcI.
\end{equation}  
Now let $j^* = n \le I$ represent the seller with the least amount of data
$\in\mcI_i$, i.e. $D^{j^*} \le D^j, \ \forall\ j \in\mcI^j$, and define $i$'s bid
vector $e_i$ with respect to its strategy, where
\begin{equation}\label{opt-eq}
    \g_i^j(a) \triangleq \begin{cases} \g_i^{j^*}(a), \quad j\in\mcI^j,\\
            0, \quad j\ni\mcI^j.\end{cases}
\end{equation}
Now, (\ref{opt-eq}) holds $\forall \ j\in\mcI$,
and we have that $\g_i$ defines an optimal strategy for buyer $i$.
}\\
\textbf{Proof:}
We assume that a buyer will try and fill their data requirement.
In the case that there exists a seller who can completely satisfy a buyers'
demand, $j^*=1$, $\vert \mcI_i\vert =1$ and (\ref{buyercoordinate}) holds. If such a buyer does not exist,
as the set $\mcI_i$ is ordered by the quantity of the sellers' bids, $i$ may discover 
$j^*$ by computing $\mcI_i$.
Suppose that $D_i >
\sum_{j\in\mcI}D^j$, then $j^* > I$ and $\mcI_i = \emptyset$. 
We model the ISP at time $t>0$ as a seller $\kappa$ with bid $s^\kappa =(d^\kappa, p^\kappa)$,
where $d^\kappa > D^j, \
\forall \ j\in\mcI_i$, and
$p^\kappa$ represents the overage fee for data set by the ISP, which we note is also the upper bound of the sellers'
pricing function, and so again (\ref{buyercoordinate}) holds.
Now, consider some $k \ne i \in \mcI$ where $p_i^j = p_k^j$. 
The allocation rule (\ref{dataallocation}) determines that the data will be
split proportionally
between all buyers with the same unit price. 
It is possible that the resulting partial allocation of data to $i$ and $k$
would not satisfy some demand. As the two cases $i$ and $k$ are the same, we
will only consider one. Suppose seller $j$ updates its
bid to reflect the new data quantity, where
$d_i^{j(t+1)} < \g_i^{j(t)}(a)$. First, $i$ sets its bid to $s_i^j = 0$, and
from the new subset $\mcI_i$, submits bids (PARALLEL OR SEQUENTIAL?) until
$\sum_{j\in\mcI_i} d_i^j \ge D_i$, by (\ref{buyercapmin}).
Now, we consider the case where a new buyer $k$ with bid
price $p_k^j > p_i^j$ for some $j \ \in \mcI_i$, in other
words, a new buyer $k$ may enter the market with a better price, decreasing the
value of $i$'s bid for $j\in\mcI_i$. In this case, by (\ref{buyercoordinate}),
$i$ will choose $\mcI_i$ so that,
$$
    \g_i^{j(t+1)}(a) = \g_i^{j(t)}(a) - \g_k^{j(t)}(a),
$$
and so $\mcI_i$ is large enough to balance the additional demand from
$k$. Thus, as in each case we have that $i$ is able to satisfy thier demand,
and we determine that the opt-out strategy is optimal.\\
\textbf{Remark:} The bid quantity $\g_i^j(a)$ and the allocation $\bar{a}_i^j$
are complementary. In fact, the buyer strategy is the first term in the
minimum, the second term being owned by the seller.

Finally, we note that $\mcI_i$ is not the only
possible minimum subset $\in\mcI$ able to satisfy $i$'s demand, it is the
minimal subset where a coordinated bid is possible.
\ref{analysis}. 

\subsubsection{Seller Strategy}
In order to to develop the seller strategy, we examine the incentive of a
rational seller with only local information in a dynamic market of many
buyers and sellers. A local auction, examined independently, may appear as
single market with a single seller and many buyers, but is in fact a subset of the
larger data-exchange market, and is subject to the trends and dynamics
therewithin. A seller must determine allocations using only bids in its local market, while the buyers' response is based on the
allocations and resulting opponent bids from all auctions in its seller pool.
In addition, buyers are allowed to bid both dynamically and asychronously. 
In order to
maximize revenue, the seller must also be able to respond dynamically to
address the mutation of competitive bids in its market. In order to do this, we
determine that the seller may modify its reserve price in response to the
changing market dynamics.

We will show that sellers are able to maximize revenue in restricted subset of
buyers in $\mcI$, and as such will attempt to facilitate a local market
equilibrium for this subset. A local auction $j$ converges when all buyer bids
remain the same over a time step, that is, if $\forall \ i \in\mcI$,
$s_i^{j(t+1)} = s_i^{j(t)}$, at which point the allocation is stable, the data
is sold, and the auction ends. In the sellers' local environment, we determine
that the best course of action is to maximize revenue, and then try to keep its
buyer pool stable until convergence occurs. Thus, the seller strategy is
complementary to that of the buyers, and is designed to achieve and maintain a
local market equilibrium. 

We describe a \emph{local} auction strategy for data allocation, where the seller is unaware of the existence of other auctions, and so
the seller behavior is the same in the case of a single buyer, a small buyer set, and in the
extreme case, where all buyers $i\in\mcI$ participate. We again note that the
seller must initialize the strategy with a first iteration, and so the auction
is defined for time $t>0$.
In our model, a local auction may be described as a progressive game of strategy with
incomplete, but perfect information, however in our analysis, as before, we will assume
complete information. 
(BUYERS ARRIVE AS A POISSON PROCESS? FUTURE WORK)

% SELLER LOCAL STRATEGY
{
\proposition{(Localized seller strategy (i.e. progressive allocation))}\label{sellerstrategy}
Define any auction duration to be $\tau \in [0,\infty)$. 
For any seller $j$, fix all other bids $[s_i^k]_{i,k\ne j \in\mcI}$ at time $t>0\in\tau$.
Define the set,
$$
    \mcI^j(n) =\argmax_{{\mcI}' \subset \mcI, \vert{\mcI}'\vert =
n}\sum_{i\in{\mcI}'} p_i^j,
$$
where,
\begin{equation}\label{sellercoordinate}
    \min\bigg\lbrace n \in\mcI \ \bigg\vert\displaystyle\sum_{i\in\mcI^j(n)}d_i^j
\ge D^j \bigg\rbrace,
\end{equation} 
so that $n$ produces a minimal subset 
of buyers that maximizes $j$'s revenue at time $t$, which we will
denote, for fixed $n$, by,
\begin{equation}\label{buyers}
    \mcI^j \subset \mcI.
\end{equation} 
Define buyer $i^* = n-1 \le I$ as the buyer with the maximum bid price $\ni
\mcI^j$.
Then, for time $(t+1)$, set $j$'s reserve price to be, 
\begin{equation}\label{newprice}
    p_i^{j(t+1)} = p_{i^*}^{j(t)} + \epsilon,
\end{equation}
Let the winner at time $t$ be determined by,
\begin{equation}\label{winner}
    \bar{i} = \displaystyle\max_{i\in I^j} p_i^{j(t)},
\end{equation}
and update $j$'s total data to reflect the (tentative) allocation,
\begin{equation}\label{newdata}
    D^{j(t+1)} = D^{j(t)} - \g_{\bar{i}}^{j(t)}(a),
\end{equation}
Allowing $t$ to range over $\tau$, we have that (\ref{sellercoordinate}) -
(\ref{newdata}) produces a local market equilibrium. 
}\\
\textbf{Proof:}
We assume that the seller will try to maximize its revenue. In the case where
$\vert\mcI^j\vert =1$, then if $\g_i^j(a)=D^j$, then $j$'s market is at equilibrium.
Otherwise, we arrive at the case of multiple buyers, which we note includes the
case where $\g_i^j(a) < D^j$, which is reflected trivially here.

For auction $j$ with multiple buyers, $i^*$ is the \emph{losing} buyer with the highest unit
price offer, determined by (\ref{sellercoordinate}), 
Suppose that for some $i\in\mcI^j$, buyer demand is not met. 
In this case, by (\ref{datacapmin}) the seller must notify $i$ of a
fractional allocation by changing the bid vector at index $i$.
With this caveat, and Proposition \ref{buyerstrategy}, we have that the
aggragate demand of subset $\mcI^j$ is satisfied by seller $j$, as in Lemma
\ref{sellerconstraints}.
Although the buyers' valuation $\theta_i$ is not known to the seller, we will assume
that buyers are bidding truthfully, and so the new reserve price $p_{i^*}^j +
\epsilon ={\theta_{i^*}}' + \epsilon$. For clarity, let the reserve price be denoted by
$p_*^j$.
Now, by the point elasticity of (\ref{buyerinversedemand}) and
(\ref{sellerinversedemand}) (PROVE POINT ELASTICITY?), we have that, $\forall \ z\ge 0$,
$$
    f_{i^*}(z) < f^j(z) \le f_i(z), 
$$
which holds $\forall \ i \in \mcI^j$, and $\forall \ j \in \mcI_i$.
We claim that the choice of reserve price $p_*^j$ does not force any buyers out
of the local auction. To show this, we use the assumption of truthful bids, and
the fact that since the auction begins at time $t>0$, buyers will
bid at least once. In a truthful reply, the term $\epsilon/\theta_i'(0)$
ensures that a new bid price differs from the last bid price by at least
$\epsilon$. Suppose the auction starts at equilibrium, so $\sum_{i\in\mcI^j}
\g_i^j(a) = D^j$ at time $t=0$. The reserve price $p_*^j$ set at time $t=0$
begins the auction with the first bid iteration, and so at $t>0$, $\forall \ i \in
\mcI^j$, we have that $p_i^j - p_*^j \ge \epsilon$.
Now, in the case where at $t=0$, $\sum_{i\in\mcI^j} \g_i^j(a) > D^j$, by
(\ref{dataallocation}), the seller notifies (any) buyer $k$ with the lowest bid price of a fractional allocation by changing
$d_k^j$ thus by Proposition \ref{buyerstrategy}, $k$ decreases its demand until
$\g_i^j(a) \le d_i^j$. Then, as the seller computes the set $\mcI^j$ at each time
step, a new $i^*$ may be chosen and the buyers bid again.
Suppose $\exists \ k \in \mcI^j$ such that $\forall \ l \ \in
\mcI_k, \ i\ni \mcI^l \ \forall \ i\ne k\in\mcI^j$. That is, $k$ is
disconnected from all other buyers $i\in\mcI^j$, and suppose that $d_k^j$
is partial allocation at $t>0$, and further suppose that there are many
$l\in\mcI_k$ where $\vert \mcI^l\vert > \vert\mcI^j\vert$. The more buyers an
auction has, the more likely that cases will occur that cause buyers to rebid,
particularly if auctions $l\in\mcI_k$ have overlapping buyers, then $k$ may
opt-out of auction $j$, i.e. $s_k^{j(t)} \ne s_k^{j(t+1)} =
0$, then the seller may simply return the tentatively allocated data to $D^j$.
Finally, we note that if for some $i\in\mcI^j \ \exists \ k\in\mcI^j$
such that $p_{i}^j = p_k^j$, then the seller again notifies the buyers of a fractional
allocation by changing $d_i^j$ and $d_k^j$ by (\ref{dataallocation}).
Thus we determine the valuation between seller
$j$ and buyer $i$ is well-posed, the reserve price (\ref{newprice}) is justified, and the local
equlibirium created by $j$ is independently stable from time $t$ to $(t+1)$. 

\subsubsection{Market Dynamics under Strategy}

We conclude this section by examining the relationship between the strategies of buyers and
sellers in local auctions. We model the impact of the dynamics of the
data-exchange market on a local auction $j$. As we have shown, the seller
is a functional extension of the buyer, with rules determined by the buyers'
behavior. This gives an auction $j$ a natural logical extension into the
global market through its buyers. We demonstrate that the symmetry between
buyer and seller behavior, consequently strategies, stretches into a symmetry across subsets of local
auctions. Additionally, we identify a clear bound restricting the influence of
local auctions on each other. We have the following Lemma,
% USER UNION
{
\lemma{(Valuation across local auctions)}\label{userunion}
For any $i,j\in \mcI$, 
\begin{equation}\label{jtoi}
j\in\mcI_i \Leftrightarrow i\in\mcI^j.
\end{equation}
Fix an auction $j\in\mcI$ with duration $\tau$ and define the influence sets of users. 
The primary influencing set is given as,
%(ALL THE SELLERS FROM EACH BUYERS POOL)
\begin{equation}\label{lambda}
    \Lambda = \displaystyle\bigcup_{i\in\mcI^j} \mcI_i,
\end{equation}
with secondary influencing set,
%(ALL THE BUYERS FROM EACH SELLER $i$ IN $j$'s BUYER POOL)
\begin{equation}\label{llambda}
    \lambda = \bigcup_{i\in\mcI^j} \bigg(\bigcup_{k\in\mcI_i} \mcI^k \bigg)
\end{equation}
\iffalse
(THE SELLERS ALL THE BUYERS IN $j$ HAVE IN COMMON! i.e. $j$ AND...)
\begin{equation}%\label{lambda}
    \Lambda = \displaystyle\bigcap_{i\in\mcI^j} \mcI_i,
\end{equation}
(THE COLLECTION OF BUYERS FROM EACH $i$ THAT ARE COMMON ACROSS ALL THE $i$'s SELLER
POOLS)
\begin{equation}%\label{llambda}
    \lambda = \bigcup_{i\in\mcI^j} \bigg(\bigcap_{k\in\mcI_i} \mcI^k \bigg)
\end{equation}
\fi
Fixing all other bids $s_i^j \in \mcI$, and time $t>0\in\tau$, we have that,
\begin{equation}\label{unioneq}
    \displaystyle\sum_{j\in\Lambda} \theta_i^j = \sum_{i\in\lambda} \theta_i^j.
\end{equation}
}\\
\textbf{Proof:}
A local auction $j\in\mcI$, is determined by the collection of buyer bid
profiles, where buyer bid $s_i^j > 0 \Rightarrow j\in\mcI_i$, and we have that $i\in\mcI^j$,
if and only if $i$'s bid is such that $p_i^j > p_{i^*}^j$, where
(\ref{sellercoordinate}) defines $i^*$ as the losing buyer with the highest bid
price in auction $j$. By (\ref{buyerinversedemand}) $p_i^j \ge
p_{i^*}^j+\epsilon$, thus $p_i^j < p_{i^*}^j$ can only happen during a market
shift, caused by the underlying dynamics.
Consider $k\in\mcI^j$ where for example, new buyers enter the auction, or increase
thier bid prices, so that $p_i^j < p_{i^*}^j\Rightarrow k\ni\mcI^j$ and
$s_k^j>0$ at time $t$. 
By Proposition \ref{buyerstrategy}, $k$ will set its bid $s_i^j=0$, and begin to add sellers to its pool.
Suppose that at time $t$, $j$'s market is at equilibrium, i.e. $\sum_{i\in\mcI^j} = D^j$, and
no buyer rebids. Unless $k$ adds a seller with a higher reserve
price within $\vert\mcI^j\vert$ time steps, by (\ref{newdata}), $D^j=0$ and the
auction will end. Otherwise, at some time $t\in[t+1,\tau]$, we must have that $\g_k^j <
D^j$, and $k$ opts-out. Finally, overlooking market transitions and messaging
overhead, we have that,
$\forall \ i\in\mcI^j$, $\nexists \ s_i^j > 0$ where $i \ni \mcI^j$, and (\ref{jtoi})
holds.
\iffalse
Furthermore, we note that $\lambda \subset \mcI$ is a complete and disjoint set
of bid vectors with respect to auction $j$. That is, $\forall \ i \in \mcI^j,
s_i^k > 0 \in \lambda$ if and only if $s_i^k>0 \in\mcI$, and so $s_i \in \lambda
\equiv s_i \in \mcI$. (NEED TO ADD TO LEMMA AND PROVE?)
\fi

Now, the subset $\mcI^j \subset \mcI$
determines $j$'s reserve price $p_{i^*}^j$. We will assume the buyer submits a
coordinated, truthful bid. Now, $\mcI_i\subset \mcI$ 
determines the unit price $p_{i}$ in buyer $i$'s bid.
The reserve price (\ref{newprice}) of seller $j$ is determined at each
transition, and is
the lowest price that $j$ will accept to perform any allocation.
Let $p_*^j = f^j \circ \g_i^j(a) $ denote the reserve
price of auction $j$, noting that $s_i^j=0, \ \forall \ i \in
[s_i^j]_{i\ni\mcI^j}$, and let $p_i^*= f_i \circ \g_i^j(a)$ denote the bid price of buyer $i$, i.e. $p_i^k = p_i^*,
\ \forall \ k \in\mcI_i$. 
Using Proposition
\ref{sellerstrategy}, for each $i \in \mcI^j$, we have from (\ref{buyerinversedemand}), (\ref{sellerinversedemand}), that $p_i^* \ge p_*^k,
\ \forall \ k \in\mcI_i$.

\iffalse
Now, we have,
\begin{equation}\label{rho}
    \rho^j(p_*^j) \le \displaystyle\sum_{i\in\mcI^j} e_i(a(s_i^j)),
\end{equation}
from (\ref{datademand}), (\ref{buyerinversedemand}),
(\ref{sellerinversedemand}), and so $p_i^j \ge p_{*}^j \ge p_i^k, \ \forall \ i \in
[p_i^j]_{i\in\mcI^j}$ and $\forall \ k \in [p_i^k]_{k\in\mcI_i}$
\fi

The incentive of each seller $\in\Lambda$ is to sell all of its data at the
best possible price. In the simplest case,
consider a disjoint local market $j$, where $\forall \ i\in\mcI^j$, $s_i^k = 0,
\ \forall \ k\ne j \in \mcI_i \Rightarrow \Lambda = \lbrace j \rbrace$ and
$\lambda = \mcI^j$. 
Again using (\ref{buyerinversedemand}) and  (\ref{sellerinversedemand}), it is
clear that $\theta_i = \theta^j, \ \forall \ i \in \mcI^j$.
In all other cases, the sellers $\in\Lambda$ are competing to sell
their respective resources to buyers whose valuations are distributed across multiple auctions. 
%By (\ref{jtoi}), $j\in \mcI_i, \ \forall \ i\in \mcI^j$. 
The set $\lambda$ represents all of the buyers influencing auction $j$, both
directly and indirectly. 
The bid price of buyer $i\in\mcI^j$ is determined by,
\begin{equation}\label{maxbid}
    p_i^* = \max_{k\in\mcI_i}\big(f^k \circ \g_i(a)\big)= \max_{k\in\mcI_i}(p_*^k).
\end{equation}
$\Lambda$ is the set of sellers directly influencing the bids of buyers
in auction $j$. Now, the reserve price for auction $j$ is such that,
\begin{equation}\label{resprice}
    p_*^j \le \min_{i\in\mcI^j}(p_i^*) - \epsilon,
\end{equation}
by Proposition \ref{sellerstrategy}. 
Also, in the absence of transitions, caused by multi-auction market dynamics, we have 
that $j$ maintains a local market
equilibrium from time $t$ to $(t+1)$. Let buyer $i\in\mcI^j$ be the buyer in auction $j$ with the lowest bid price,
and further suppose $p_i^* > p_*^j + \epsilon$. That is, $\exists \ q \in \mcI_i$ such
that $p_*^q > p_*^j$. Fixing all other bids, a change in $q$'s valuation from time $t$ to $t+1$ will
directly impact buyer $i$. If at time $t+1$ we still have that $i$ is the
buyer with the lowest bid price, then (\ref{sellerinversedemand}) holds and
thus $j$'s valuation does not change. Otherwise a new buyer with the lowest bid will be chosen upon
recomputing $\mcI^j$, as in Proposition \ref{buyerstrategy}. 
In each case we
have that (\ref{buyerinversedemand}) and (\ref{sellerinversedemand}) hold for
some fixed time $t$, and so, $\forall \ i \in\mcI^j$,
\begin{align*}
    \int_0^{\g_i^j(a)} f^j(z) \ dz &= \theta_i^j \circ \g_i^j(a)\\
    &= \int_0^{\g_i^j(a)} f_i(z) \ dz,
\end{align*}
therefore $\theta_i = \theta^j, \ \forall \ i \in \mcI^j$.
Furthermore, it follows that,
\begin{equation}\label{jdemand}
    \displaystyle\sum_{i\in\mcI^j}\int_0^{\g_i^j(a)} f^j(z) \ dz =
\sum_{j\in\mcI_i}\int_0^{\g_i^j(a)} f_i(z) \ dz.
\end{equation}

Consider the set $\lambda$. For some buyer $i\in\mcI^j$, and then for
some seller $k \in \mcI_i$, we have a buyer $l \in \mcI^k$. By (\ref{jtoi}), $i,l \in \mcI^k$, and so the reserve price $p_*^k \le \min(p_l^*,
p_i^*)$, and $k, j\in \mcI_i\Rightarrow p_i^* \ge \max(p_*^k, p_*^j)$.
Suppose that $l \ni \mcI^j\Leftrightarrow j \ni \mcI_l$, so
that $p_l^* < p_*^j$, and
the valuation of buyer $l$ does not impact auction $j$ and vice versa, i.e. $\theta_l^j = 0$. Since $l\in\mcI^k$, $p_l^* \ge p_*^k\Rightarrow
p_*^k < p_*^j$, and $i\in\mcI^j \Rightarrow p_i^* \ge p_*^j$, so,
$$
    p_*^k \le p_l^* < p_*^j \le p_i^*,
$$
for any buyer $l\in\lambda$ such that $l\ni \mcI^j$. Now, suppose $\exists \ l\in\mcI^k$ such that $l\in\mcI^j \Rightarrow p_l^* \ge
p_*^j$. In the case where $p_l^* > p_i^*$, we must have that 
$\exists \ q \in \mcI_l$ such that $p_*^q > p_*^k$, % \Rightarrow \theta_l^q > \theta_l^k$. 
which implies, again by (\ref{maxbid}), $q\ni\mcI_i \Leftrightarrow i
\ni\mcI^q \Rightarrow p_*^q >
p_i^*$, therefore $\theta_i^q = 0$, and the reserve price of auction $q$ does not effect the valuation of
buyer $i$. 
Lastly, in the case where $p_i^* > p_l^*$, by the same reasoning, $\theta_l^q = 0$.
We have that for any $l\in\mcI^k$ such that $l\ni
\mcI^j$, $\theta_l^j =0$, and when $l\in \mcI^j$, then either $\theta_i^q =0$
for $q\in\mcI_l$ or $\theta_l^q = 0$ for some $q\in\mcI_i$. Thus, any bid ouside of
our construction
has a zero valuation, with respect to buyers $\in\lambda$ and sellers
$\in\Lambda$, and therefore cannot cause transitions to occur except through a
shared buyer, e.g. some $l\in\mcI^k$. Thus, in all cases,
(\ref{buyerinversedemand}) and (\ref{sellerinversedemand}) hold. Fixing all
bids in any auction $\mcI^q$, where $q\in \mcI_l \setminus \Lambda$,
we have, $\forall \ k\in\mcI_i$,
\begin{equation}\label{idemand}
    \displaystyle\int_0^{D^k} f^k(z) \ dz = \sum_{i\in\mcI^k}\int_0^{\g_i^k(a)}
f^k(z) \ dz,
\end{equation}
which holds $\forall \ k\in\mcI_i$, by (\ref{jtoi}) and Proposition
\ref{sellerstrategy}..
Finally, using (\ref{jdemand}), (\ref{idemand}), $\forall \ i\in\mcI^j, \forall \ k\in\mcI_i,\forall \ l\in\mcI^k$,
\begin{align*}
    \int_0^{\g_i^k(a)} f_i(z) \ dz &= \int_0^{\g_i^k(a)} f^k(z) \ dz,
\end{align*}
and
\begin{align*}
    \int_0^{\g_l^k(a)} f^k(z) \ dz &= \int_0^{\g_l^k(a)} f_l(z) \ dz,
\end{align*}
and the result follows by construction, and the continuity of $\theta'$:
\begin{equation}\label{union-eq}
    \sum_{i\in\lambda}\int_0^{\g_i^j(a)} f^j(z) \ dz = \sum_{j\in\Lambda}\int_0^{\g_i^j(a)} f_i(z) \ dz.
\end{equation}

For completeness, in the case where the ISP $\kappa$ 
does not adhere to the market dynamics, so $p^\kappa > p^j +
\epsilon, \ \forall \ j \in\mcI$, then we may absorb the overage (difference) as part of the
bid fee.
(NEED TO DO BETTER WITH TIME?)

As a result of user behavior, and subsequent strategies, we determine that the data-exchange market is
semi-partitioned, consisting of unions as in Lemma \ref{userunion}. The unions are inter-dependent in a predictable way. However, as
each auction may be played on the same or on a different scale in
valuation, time and quantity, the rate at which market fluctuations occur is
impossible to predict (NEED HELP!). 
Arrow's paradox is an impossibility theorem stating that when buyers have three
or more distinct alternatives (auctions), no deterministic ranking system can
convert the ranked preferences of users into a market-wide (complete
and transitive) ranking while also meeting a specified set of criteria:
unrestricted domain, non-dictatorship, Pareto efficiency and independence of
irrelevant alternatives. It follows that the case where
$\theta_i = \theta^j$ as in (\ref{buyerinversedemand}) and
(\ref{sellerinversedemand}) does not exist, and is purely a potential,
theoretical ideal. (DOES IT????)

Nonetheless, we claim that our mechanism is normative, that irrelevant
alternatives should not matter, it is practical, uses minimal information,
strategy, and provides the right incentives for the truthful revelation of individual preferences. 
(EXPAND)

Consider a user seeking to prevent
data overage charges by purchasing data from a subset of other network users.
The sellers' auction will function as follows: at each bid iteration all buyers
submit bids, and the winning bid is the buyer $i$ that has the highest price
$p_i^j$. The seller allocates
data to this winner, at which point all other buyers are able to bid again, and
the winner leaves the auction (with the exception where multiple bidders bid
the same price, where (\ref{dataallocation}) determines they will not fully
satisfy their demand, and so we will assume they remain in the auction). The auction progresses as such until all the
sellers' data has been allocated. 
Each time step, $s^j$ is updated it is shared with all
participating buyers. At this point buyers have the opportunity to bid again,
where a buyer that does not bid again is assumed to hold the same bid, since a
buyer dropping out of the auction will set their bid to $s_i^j=(0,0)$. We
define a single iteration of the auction, wher a seller updates bid vector
$s^j$, and the buyers' response $s_i$, to comprise a single time step. 

% SELLER ALGORITHM
\begin{algorithm}[H]
\caption{(Seller progressive allocation)}
\begin{algorithmic}[1]
\State $p^{j(0)} \gets \epsilon$, $s^{j(0)} \gets (p^j, D^j)$, $\bar\mcI =
\emptyset$, compute
$\mcI^{j(0)}$
\State Update $s^j$ 
\While{$D^j(t) > 0$}
\State $\bar{i} \gets \displaystyle\max_{i\in I^j}\sum_{i\in I^j} p_i^j$ 
\State $D^{j(t+1)} \gets D^{j(t)} - \g_{\bar{i}}^{j(t)}(a)$
%\State $p^j \gets \theta_{i^*}'(d_{i^*}^j)\circ e_i$
\State $p^j \gets p_{i^*}^j+\epsilon$ and $d^j \gets D^{j(t+1)}$
\State $s^{j(t+1)} \gets (d^j, p^j)$
\State Update $s^j$
\State $\bar\mcI \gets \bar\mcI \cup \bar{i}$
\For{$k \in \bar\mcI$}
\If{$p_k^j < p_{i*}^j$}
\State $D^{j(t+1)} = d_k^{j}$
\State $\bar\mcI \gets \bar\mcI \setminus \lbrace k \rbrace$
\EndIf
\EndFor
\State Compute $\mcI^{j(t)}$
\State $\mcI^{j(t+1)} = \mcI^{j(t)}\setminus \bar\mcI$
\State $t \gets t+1$
\State Go to 4.
\EndWhile
\end{algorithmic}
\end{algorithm}
Finally, we give a simple example of a convergence to a local market equilibrium, where the buyers are assumed to respond with their
$\epsilon$-best replies.
\begin{center}
\begin{tabular}{c|c|c}
Name & Bid total & Unit price\\
\hline
A & 50 & 1\\ 
B & 40 & 1.2\\
C & 26 & 1.5\\
D & 20 & 2\\
E & 14 & 2.2
\end{tabular}
\end{center}
Let $s^{(1)} = [(65,\epsilon)]_{i\in\mcI}$ and
$s^{(2)}=[(85,\epsilon)]_{i\in\mcI}$. The buyer bids are as follows: 
\begin{align*}
    s_A &= [(0,0), (50,1)], \\
    s_B &= [(0,0), (40,1.2)], \\
    s_C &= [(0,0),(26,1.5)], \\
    s_D &= [(0,0),(20,2)], \\
    s_E &= [(0,0), (14,2.2)]. 
\end{align*}
Then at $t=1$, we have 
bid vector $s^{(2)}=[(0,p^{(2)}), (20,p^{(2)}), (26,p^{(2)}), (20,p^{(2)}),\\
(14,p^{(2)})]$, and so  $(D^{(2)},p^{(2)}) = (85, 1+\epsilon)$, The buyer response is,
\begin{align*}
    s_A &= [(50,1), (0,0)], \\
    s_B &= [(40,1.2), (0,0)], \\
    s_C &= [(0,0),(26,p^{(2)})], \\
    s_D &= [(0,0),(20,p^{(2)})], \\
    s_E &= [(0,0),(14,p^{(2)})].
\end{align*}
At $t=2$, $(D^{(1)},p^{(1)}) = (65,1+\epsilon)$, with
bid vector $s^{(1)}=[(25,p^{(1)}), (40,p^{(1)}), (0,0),\\ (0,0),
(0,0)]$. $(D^{(2)},p^{(2)}) = (25, 1+\epsilon)$. Then,
\begin{align*}
    s_A &= [(25,p^{(1)}), (25,p^{(2)})], \\
    s_B &= [(40,p^{(1)}), (0,0)], \\
\end{align*}
where we have removed bids to indicate winner(s) with a tentative allocation.
At $t=3$, $(D^{(1)},p^{(1)}) = (50,1+\epsilon)$, with
bid vector $s^{(1)}=[(25,p^{(1)}), (40,p^{(1)}), (0,0),\\ (0,0),
(0,0)]$. $(D^{(2)},p^{(2)}) = (0, 1+\epsilon)$ and $s^{(2)}=[(25,p^{(1)}),
(0,0), (26,p^{(2)}), (20,p^{(2)}),\\(14,p^{(2)})]$. Then,
\begin{align*}
    s_A &= [(25,p^{(1)}), (0,0))].
\end{align*}
At $t=4$ the auction ends.\\
\textbf{Remark:} In the case where market resources do not satisfy (\ref{buyercapmin}), however as
this constraint is not restricted in time, we reason that in the case of
insufficient data in the market buyers may wait for additional sellers or
purchase from the ISP, $\kappa$, as a monopoly sale. Similarly, for (\ref{datacapmin}) in
the case of insufficient demand, where we may assume that data is held at time
$t=0$ by $\kappa$ at bid price $\epsilon$.

% VCG ANALYSIS
\section{PSP Analysis}\label{analysis}


\subsection{Equilibrium}

We intend to show evidence shared network optima (a
global optimum). 
A buyer $i\in\mcI$ will have incentive to change its bid
quantity if it increases its opt-out value $\g_i$, and therefore its utility (\ref{buyerutility}). 
We will show that, without loss of utility, buyer $i$ may  
use a ``consistent" bid strategy within its seller pool, i.e. $d_i^j = d_i^k, \
\forall \ j,k \in \mcI_i$, and as such,
Proposition \ref{buyerstrategy} supports an optimal strategy with respect to
(\ref{buyerutility}). 
Our result shows that a buyer may select $\mcI_i$ in order to maximize its
utility while maintaining a coordinated bid strategy. 
Reasonably, if $j^*< I$, a buyer may increase the size of its seller pool
$\mcI_i$, thereby lowering its coordinated bid
quantity while obtaining the same (potential) allocation $a_i$. 
As buyer $i$ submits identical bids to multiple auctions, the bid price must be
as high as the highest reserve price $p_i^j \in \mcI_i$.
Buyer $i$'s bid then has identical bid price $p_i^j \forall \ j \in\mcI_i$. 
We further note that $i$ optimal strategy does not require reducing its bid price to a
minimum in each auction, where
the bid quantity $\g_i^j(a)$ is still fufilled. The pricing rule of the PSP
auction dictates that a buyer $i$ will pay the cost of excluding other players from
the auction, and as $i$'s bid price reflects its valuation of it data
requirement $D_i$ across all local markets, we have identical bid prices in
each auction where $s_i^j>0$. Obviously, if $j\ni\mcI_i$, then $\theta_i^j = 0$.

% BUYER COORDINATION
{
\lemma{(Opt-out buyer coordination)}\label{coordinationlemma} 
Let $i\in\mcI$ be a opt-out buyer and fix all sellers' profiles $s^j$.
For any profile $S_i = (D_i, P_i)$, let $a_i \equiv \sum_j a_i^j(s)$ be a
tentative data
allocation. For any fixed $S_{-i}$, a better reply for $i$ in any auction is $x_i =
(z_i,y_i)$, where $\forall \ j \in \mcI_i$,
\begin{align*}
    z_i^j &= \g_i^{j^*}(a), \\
    y_i^j &= \theta_i'(z_i^j).
\end{align*}
Furthermore,
\begin{equation}\label{allocationcoordination}
    a_i^j(z_i,y_i) = z_i^{j},
\end{equation}
and
\begin{equation}\label{costcoordination}
    c_i^j(z_i,y_i) = y_i^{j},
\end{equation}
where $i$'s strategy is as in Proposition \ref{buyerstrategy}.
}\\
\textbf{Proof:}
As $s_{-i}$ is fixed, we omit it, in addition, we will use $u\equiv u_i \equiv u_i(s_i) \equiv
u_i(s_i;s_{-i})$. In full notation, we intend to show
$$
    u_i((d_i,p_i);s) \le u_i((z_i,y_i);s_{-i}).
$$
Now, if there exists a seller who can fully satisfy $i$'s demand,
then $\vert\mcI_i\vert = 1$, and the case is trivial as no
coordination is necessary for a single bid. %(SPECIAL CASE OF MONOPOLY? THINK!)\\
Otherwise, buyer $i$'s demand can only be satisfied by purchasing data from
multiple sellers.
We will show that $i$ may increase $\vert\mcI_i\vert$, and so decreasing
$d_i^j, \ \forall \ j\in\mcI_i$, without decreasing $\sum_{j\in\mcI_i}u_i^j$.
Buyer $i$ maintains ordered set $\mcI_i$ where the sellers with the
largest bid quantities are considered first; the index of seller $j^*$ defines
a minimal subset $\mcI_i$, satisfying (\ref{buyercoordinate}). By construction, 
$d_i^{j^*}$ is the minimum quantity bid offered by any $j\in \mcI_i$,
so $d_i^{j^*} \le d_i^j, \ \forall \ j \in \mcI_i$. 
Thus by (\ref{buyercoordinate}) and (\ref{opt-eq}), $\forall \ j\in \mcI_i$,
$k\ni\mcI_i$,
$$
    \g_i^k(a) \le z_i^j = \g_i^{j^*}(a) \le \g_i^{j}(a),
$$
and so, using (\ref{union-eq}), 
\begin{equation}\label{minimaleq}
    \g_i^{j^*}(a)  \le \bigg\lbrack D^{j} - \sum_{k\in \mcI^j : p_k^{j}> y_{i}^{j}} d_k^{j}\bigg\rbrack^+.
\end{equation}
Now, the buyer valuation function (\ref{buyervaluation}), guarantees
that $\forall \ j\in\mcI_i$, $y_i^j \ge p_{i^*}^j$, where $p_{i^*}^j$ is the reserve price of seller $j$, defined in Proposision
\ref{sellerstrategy}, and is by definition the minimum price for a buyer bid to
be accepted. 
As $\bar{D}_i^j$ is non-decreasing, $\forall \ j\in \mcI_i$,
$k\ni\mcI_i$,
$$
    D_i^j(y_i^j) \ge D_i^j(p_i^{j^*})\ge D_i^j(p_i^{k}).
$$
\iffalse
Furthermore, suppose there exists buyer $k\in \mcI^j$, such that
$\g_k^{j^*}(a) \ge \g_i^{j^*}(a)$ and $D^j - \sum_{k\in\mcI^j,k\ne i}d_k^j < z_i^{j}$, resulting in a
partial allocation. Bid $s_k^j \in s_{-i}$, and so is considered in buyer $i$'s strategy. 
As buyer $i$ is allowed to choose subset $\mcI_i$, and $\mcI_i$ is a minimal
set, (\ref{buyercoordinate}) states that $n$ is such that $\g_i^{j*}(a)
\ge \g_k^{j^*}(a)$ for any $k\in\mcI$, therefore such a buyer $k$ cannot exist.
We have, $\forall \ j\in \mcI_i$, $k\ni\mcI_i$,
$$
    {\theta_i}'(e_i^{k}(a)) \ge {\theta_i}'(e_i^{j^*}(a)) \ge y_i^j.
$$
Now, suppose that $p_k^j = p_i^j$, however $d_k^j > d_i^j$...
\fi
Thus (\ref{minimaleq}) holds and so, by (\ref{dataallocation}),
\begin{align*}
     a_i^j(z_i,p_i) &=\min_{i\in\mcI^j}\bigg(z_i^j, \bigg\lbrack D^{j} - \sum_{p_k^{j}> y_i^{j}}
d_k^{j}\bigg\rbrack^+\bigg) \\
    &= z_i^{j}= e_i^{j^*}(a)
\end{align*}
where the last equality is by definition, and so (\ref{allocationcoordination}) is proven.
From (\ref{datacomposed}), $\bar{D}_i^j(y, s_{-i}) =
0 \ \forall \ y < p_{i^*}^j$, and $\bar{D}_i^j(y, s_{-i}) =0 \le \epsilon
\Rightarrow \g_i^j(a) = 0 \Rightarrow z_i^k = 0, \ \forall \ k \ni \mcI_i$, and therefore,
\begin{align*}
    \displaystyle\sum_{j\in\mcI_i} c_i^j(z_i,y_i) =\sum_{j\in\mcI_i}
c_i^j(z_i,p_i),
\end{align*}
thus (\ref{costcoordination}) simply shows that changing the price $p^j_i$ to $y^j_i$ does not exclude any
additional buyers, as the bid $p^j_i$ was already above the reserve price of any
seller $j \in \mcI_i$.
We proceed to show that $x_i$ does not result in a loss of utility for
buyer $i$, that is,
$$
    u_i \le u_i(z_i,y_i).
$$
From (\ref{allocationcoordination}), we have $a_i^{j}(z_i,y_i) = z_i^{j} = \g_i^j(a(z_i,y_i))$, 
and so,
$$
    \theta_i\circ \g_i^j(a(z_i,y_i)) = \theta_i\circ \g_i^j(a),
$$ 
which holds $\forall \ j\in\mcI_i$.
Therefore, by the definition of utility (\ref{buyerutility}),
and the buyers' valuation (\ref{buyervaluation}), 
\begin{align*}
    &\theta_i\circ \g_i(a(z_i,y_i)) - \theta_i(a)\circ \g_i(a) \\
    &= u_i(z_i,y_i) - u_i =  \displaystyle\sum_{j\in\mcI_i} c_i^j -c_i^{j}(z_i,y_i)\\
    &= \sum_{j\in\mcI_i}\int_{a_i^j(z_i,p_i)}^{a_i^j} f_i(d_i^j - x) \ dx.
\end{align*}
Then, as $a_i(z_i,p_i) \le z_i^j \le a_i^j $, and noting that
$z_i^j>0\Rightarrow \theta_i\ge 0\Rightarrow f_i\ge 0$, we have $u_i(z_i,y_i) - u_i \ge 0$, $\forall \ j\in\mcI_i$.
%Finally, we note that $z_i^j$ does not increase the aggragate demand of the buyer.

\subsubsection{Incentive Compatibility}

The property of truthfullness is an essential component of equilibrium in
second-price markets. The strategies described in this paper have removed the
necessity for a user to determine its own valuation function, and due to our
construction, we intend to show that truthful bids are optimal for all users,
i.e. bid prices are to the marginal value as determined by market dynamics. 
To achieve incentive compatibility, we find that the opt-out buyer must choose
this subset so that its overall marginal value is greater than its market price.

(DO I NEED TO PROVE CONTINUITY TOO?)

{
\proposition{(Incentive compatibility across local auctions)}
Let $\Lambda$, $\lambda$ be defined as in Lemma (\ref{userunion}), and fix time
$t>0 \in \tau$, and fix $s^j, \ \forall \ j\in\Lambda$, and for some
buyer $i\in \mcI^j$, (DO I WANT LAMBDA? SO MANY CASES) let $s_k$ also be fixed $\forall \ k\ni i \in \lambda$. Define,
\begin{align}
\begin{split}\label{eta}
    \eta_i &= \sup\bigg\lbrace x\ge 0 : 
 {\theta_i}'(x) > \displaystyle\sum_{k\in\lambda} P_k^j(x)\bigg\rbrace, 
\end{split}\\
\begin{split}\label{chi}
    \chi_i &= \sup\bigg\lbrace x\ge 0: x \le
\displaystyle\sum_{k\in\lambda}D_i^j(\theta_i'(x)) \bigg\rbrace,
\end{split}
\end{align}
$z = \min(\eta_i, \chi_i - \epsilon / \theta_i'(0))^+$, and for each $j \in
\mcI_i$, 
$$
    v_i^j = \g_i^{j^*}(z) 
$$
and 
$$
    w_i^j = \theta_i'(z).% \circ e = \theta_i'(v_i^j).
$$
Then a (coordinated) $\epsilon$-best reply for the opt-out buyer is $t_i =
(v_i,w_i)$, i.e., $\forall \ s_i, u_i(t_i;s_{-i}) + \epsilon \ge u_i(s_i;
s_{-i})$.
%and fix $j$'s reserve price $p^j$ as is defined by (\ref{newprice}). 
With reserve prices $p^j >0$, there exists a ``truthful" local game embeddeded
in each local auction, and thus an equilibrium point for the local auction. 
}\\
\textbf{Proof:}

For the buyer, we show that $t_i$ is an $\epsilon$-best reply. That is,
$$
    u_i(t_i;s_{-i}) + \epsilon \ge u_i(s_i;s_{-i}).
$$
Let $z = \eta_i^j$, and again let $p_*^j = f^j \circ \g_i^j(a) $ denote the reserve
price of auction $j$, and $p_i^*= f_i \circ \g_i^j(a)$ denote the (coordinated) bid price of buyer $i$. 
We have that $i\in\mcI^j$, 
and (\ref{buyerinversedemand}) defines $\theta_i'(z)$ as being
max of the reserve prices $p_i^j,\ \forall \ j\in\mcI_i$, therefore
(\ref{eta}) is such that,
$$
    \theta_i'(z) > \bar{P}_i^j(z),
$$ 
which implies, as (MORE) $\theta_i'$ is non-increasing and $P_i^j \ge 0$,
we have $\forall \ j \in \mcI_i$, 
\begin{align*}
    w_i^j &> P_i^j(v_i^j) \\
    \Rightarrow v_i^j &\le D_i^j(w_i^j) = D^j - \rho^j(w_i^j).
\end{align*}
And so, by (\ref{dataallocation}),
\begin{align*}
    a_i^j(t_i) &= v_i^j \\
    \Rightarrow \displaystyle\sum_{j\in\mcI_i} a_i^j(t_i) &= z.
\end{align*}
Therefore,
\begin{align*}
    \displaystyle\sum_{j\in\mcI_i}&\int_0^{v_i^j} P_i^j(x) \ dx =  \int_0^{z}
    \bar{P}_i^j(x) \ dx \\
    &= \sum_{j\in\mcI_i}\int_0^{e_i^j(z)} P_i^j(x) \ dx.
\end{align*}
Suppose $\exists \ s_i = (d_i, p_i)$ such that $u_i^j(s_i;s_{-i}) > u_i^j(t_i;
s_{-i}) + \epsilon$. The buyer coordinated strategy, from Propositions
\ref{coordinationlemma} and
\ref{buyerstrategy}, gives $s_{i^*} = (e_i\circ a_i(s), \ \theta_i'(z)) =
(z_i, c_i)$, where
for each $j\in \mcI$, $a_i^j(s_{i^*}; s_{-i}) = z_i^j$,
then clearly $u_i(s_{i*}, s_{-i}) \ge u_i(s_i, s_{-i}) \Rightarrow u_i(t_i;s_{-i}) -
u_i(s_i;s_{-i}) > \epsilon$. Denoting $z_i^j$ (fixed) as $\zeta$, 
$$
    \int_z^{\zeta} {\theta_i}'(x) \ dx- \int_z^{\zeta} \bar{P}_i(x) \ dx > \epsilon.
$$
For concave valuation functions, the first-order derivative of $\theta$ at point
$0$ gives the maximum slope of the valuation function, and so the factor $\epsilon
/ \theta'(0)$ guarantees that new bids will differ by at least
$\epsilon$, and as such, buyer $i$ will remain in
any local auction with reserve price determined by (\ref{???}). We therefore
verify that,
$$
    \displaystyle\int_{z}^{z +\epsilon / \theta_i'(0)} \theta_i'(x) \
dx \le \epsilon,
$$
and as $P_i^j \ge 0$, we have that, from the construction of $\zeta$,
$$
    \displaystyle\int_{z+\epsilon / \theta_i'(0)}^\zeta \theta_i'(x) \ dx -
\int_{z+\epsilon / \theta_i'(0)}^\zeta \bar{P}_i(x) \ dx > 0.
$$
If $\zeta > z + \epsilon / \theta_i'(0)$, then for some $\delta >0$,
$\theta_i(z+\epsilon / \theta_i'(0)+\delta) > P_i^j(z+\epsilon /
\theta_i'(0)+\delta)$, contradicting (\ref{eta}).
Now, if $\zeta \le z$, then $\theta_i'(z+\epsilon / \theta_i'(0)) < P_i^j(z+\epsilon /
\theta_i'(0))$, also a contradiction of (\ref{eta}), and so buyer $s_i$ cannot
exist.

We consider the other term in the minimization; let $z=\chi_i$. We have that
For any coordinated bid $s_i$ such that $u_i(z_i, c_i) > u_i(t_i)+
\epsilon$, then $\zeta > z
\Rightarrow c_i(s_{i}) > b_i$, and so is infeasible. 
Finally, by Lemma \ref{userunion}, for a single buyer-seller interaction, we
have that $f_i = f^j \Rightarrow \theta_i \circ e_i^j = \theta^j \circ e_i^j$.
Therefore $\theta_i' = {\theta^j}'$. We have by Proposision
\ref{sellerstrategy} and (\ref{???}eqn 30), that $\theta^j = \max_{i\in\mcI^j}
\theta_i$, and so for any $i\in\mcI^j, \theta^j(z) \ge \theta_i(z)$, and so $j$
cannot set a higher reserve price, and also cannot sell more data than the buyers'
bids, so we have that $j$'s bid is both truthful and optimal.
\\----------------------REF-------------------------\\
% NEW MARKET PRICE
\begin{align}
\begin{split}
    &\bar{P}_i(z, s_{-i}) =\displaystyle\sum_{j\in\mcI}P_i^j(z_i^j,
s_{-i}^j) \\
    &= \sum_{j\in\mcI}\bigg(\inf\bigg\lbrace y\ge 0 : 
    {D_i^j}(y,s_{-i}^j) \ge e_i^j(z) \bigg\rbrace \bigg),\\
\end{split}
\end{align}
% NEW ALLOCATION RULE
\begin{align}
\begin{split}
    D_i^j(y,s_{-i}^j) = \bigg\lbrack D^j - \sum_{p_k^j> y} d_k^j\bigg\rbrack^+,
\end{split}
\end{align}
% NEW INVERSE DEMAND
\begin{align}\label{datapriceinverse}
\begin{split}
    \bar{D}_i(y, s_{-i}) &= \displaystyle\sum_{j\in\mcI}\bigg(\sup\bigg\lbrace z\in \big[ 0,
    D^j \big] : \\
    &\bar{P_i}(z,s_{-i}^j) < y\bigg\rbrace\bigg).
\end{split}
\end{align}
% DATA ALLOCATION RULE
\begin{align}
    a_i^j(s) \\
    &= \min\bigg\lbrace e_i^j(D_i),
    \frac{d_i^j}{\sum_{p_k^j= p_i^j}d_k^j} D_i^j(p_i^j,s_{-i}^j)\bigg\rbrace.
\end{align}
% DATA COST
\begin{align}
\begin{split}
    \bar{c}_i(s) &= \displaystyle\sum_{j\in\mcI} 
p^j \bigg(ai^j(0; s_{-i}^j)
    -a_i^j(s_i^j;s_{-i}^j)\bigg).
\end{split}
\end{align}
% BUYER DEMAND 
\begin{equation}
    \rho^j(y) = \sum_{i\in\mcI : p_i^j\ge y} d_i^j, 
\end{equation}
% BUYER REVENUE 
\begin{equation}
    f_i(z) \triangleq \inf\big\lbrace y\ge 0:
        \rho_i^j(y) \ge z, \ \forall \ j \in \mcI\big\rbrace.
\end{equation}
% SELLER REVENUE 
\begin{equation}
    f^j(z) \triangleq \sup\big\lbrace y\ge 0:
        \rho_i^j(y) \ge z, \ \forall \ i \in \mcI\big\rbrace,
\end{equation}
\begin{equation}
    \theta_i \circ e_i^j = \int_0^{e_i^j(a)} f_i(z) \ dz,
\end{equation}
\begin{equation}
    \theta_i \circ e = \displaystyle\sum_{j\in\mcI}
 \int_0^{e_i^j(a)} f_i(z) \ dz.
\end{equation}
\begin{equation}
    \theta^j \circ e = \displaystyle\sum_{i\in\mcI}
 \int_0^{e_i^j(a)} f^j(z) \ dz.
\end{equation}
\begin{equation}
    d_i^j \ge e_i^j(a)
\end{equation}
\begin{equation}
    \displaystyle\sum_{i\in\mcI} e_i^j(a) \le \sum_{i\in\mcI} d^j_i \le D^j,
\end{equation}
\begin{equation}
    e_i^j(a) \le D^j - \sum_{k\in\mcI, k\ne i} e_k^j(a).
\end{equation}
\begin{equation}
   p_i^j \ge \min_{i\in\mcI}\big(p_i^j).
\end{equation}
\\----------------------------------------------------\\
This forms a ``truthful" local game embeddeded within $j$'s auction with strategy space
restricted to $\epsilon$-best replies from buyers $\in \mcI^j$. Therefore we have that a
fixed point in the ``truthful" local game is a fixed point for the auction. We
further argue that as the set $\mcI^j$ is
computed at each bid iteration, that our result holds for time $(t+1) \in \tau$.

A Nash equilibrium is defined as a strategy vector, or, in terms of PSP, a bid
profile $s$,
from which no player has a unilateral incentive to deviate (Johari, 2004)


As a result of auction initialization, a seller $j$'s valuation defines its
reserve price to be determined
by a buyer $i \ni \mcI^j$, even if this price is zero, we have that $p^j = \epsilon \ge 0$.
We argue that if truthfulness holds \emph{locally} for both buyers and sellers, i.e. $p_i ={\theta_i}' \
\forall \ j \in \mcI_i$ and $p^j = {\theta^j}' \ \forall \ i \in\mcI^j$, then
there exists a local market equilibrium extending over a subset of connected
local markets. We have the following Proposition. 

{
\lemma{(Static Data Nash Equilibrium)} 
}

% DATA NASH EQ
{
\theorem{(Data Nash Equilibrium)}
Using the rules of the data auction mechanism, the CMHK
\cite{zheng} converges to a $\epsilon$-Nash equilibrium. In the network auction
game with the data-PSP rules applied independently by each user according to their respective strategies, the secondary market converges to an $\epsilon$-Nash
equilibrium. 
}\\
\textbf{Proof:}
2. using the min price of sellers in the auction i.e. ${\theta_i}'(d_{i^*}^j) =
p^j$ is OK, \\
3. that bids are still feasible AND optimal \\
4. the algorithm achieves global economic equilibrium)\\
\textbf{NEED TO COVER:}\\
1. Change in buyer valuation \\
2. New buyers\\
3. Not enough buyers \\
4. Not enough data\\
\textbf{TRY:}\\
Sellers only act when the resources obtained by the buyers influence their
respective reserve prices, which agrees with the seller stragety of attempting
to sell their data in the first iteration. Therefore we claim there exists a
market stability and therefore, the existence of a Nash equilibrium. As the
valuation of the sellers is derived by the demand of the buyers, who are
bidding equivalent bids over a minimum subset of buyers, we claim that the seller
strategy, along with the seller constraint (\ref{??}) results in a global
market equilibrium.
We have shown that the local
equlibirium created by $j$ is stable from time $t$ to $(t+1)$. 
Now, suppose that buyer $i^*$ computes its best response $s_i^j = (v_i^j, w_i^j)$
Finally, suppose that
a buyer $k$ enters the market such that for some buyer $l\in\mcI^j$,
$$
    \displaystyle\sum_{i\in\mcI^j} p_i^je_i^j(a) + p_k^je_k^j(a) \ge
\sum_{i\in\mcI^j} p_i^je_i^j(a) - p_l^je_l^j(a),
$$
that is,



NOTES: (today)\\
2. finish seller incentive compat\\
3. work on progression\\
4. check reserve price = monopoly price


\subsection{Efficiency}

Formally, the
mechanism is equilbriumcient if at equilibrium, the allocation maximizes
$\sum_i\theta_i(a_i)$.
(NEED OWN WORDS)
The objective in designing the auction is that, at equilbrium, resources al-
ways go to those who value them most. Indeed, the PSP mechanism does
have that property. This can be loosely argued as follows: for each player,
the marginal valuation is never greater than the bid price of any opponent
who is getting a non-zero allocation. Thus, whenever there is a player j
whose marginal valuation is less than player i 's and j is getting a non-zero
allocation, i can take some away from j , paying a price less than i 's marginal
valuation, i.e. increasing u i , but also increasing the total value, since i 's
marginal value is greater. Thus at equilibrium, i.e. when no one can unilat-
erally increase P their utility, the total value is maximized.

\subsection{Convergence}

\end{multicols}

\begin{thebibliography}{9}

\bibitem{zheng}
L. Zheng, C. Joe-Wong, C. W. Tan, S. Ha and M. Chiangs, 
\textit{Secondary markets for mobile data: Feasibility and benefits of traded
data plans}, 2015 IEEE
Conference on Computer Communications (INFOCOM), Kowloon, 2015, pp. 1580-1588.

\bibitem{lazar}
A. A. Lazar and N. Semret, 
\textit{Design and Analysis of the Progressive Second Price Auction for Network
Bandwidth Sharing,} Telecommunication Systems, Special Issue on Network Economics, 2000.

\bibitem{semret} 
N. Semret, 
\textit{Market Mechanisms for Network Resource Sharing,
Ph.D. thesis}. 
Columbia University, 1999.

\bibitem{tuffin}
Bruno Tuffin,
\textit{Revisited Progressive Second Price Auction for Charging
Telecommunication Networks}.
[Research Report] RR-4176, INRIA, 2001.

\bibitem{qpsp}
Clare W. Qu, Peng Jia, and Peter E. Caines,
\textit{Analysis of a Class of Decentralized Decision Processes: Quantized
Progressive Second Price Auctions},
46th IEEE Conference on Decision and Control, New Orleans, LA, 2007, pp.
779-784.

\bibitem{cmhk}
\textit{China Mobile Hong Kong Company Limited}.
\url{https://www.hk.chinamobile.com/en/corporate_information/Data_N_VAS/DataTopup/index.html}.
2018

\bibitem{iia}
Andreu Mas-Colell, Michael Dennis Whinston, and Jerry R. Green, 
\textit{Microeconomic Theory}. Oxford University Press. 1995. p. 794.

\bibitem{matt}
Matthias Roggendorf and Fernando Beltr{\'a}n,
\textit{Simulation Model for the Dynamic Allocation of Network Resources in a
Competitive Wireless Scenario}. Mobility Aware Technologies and Applications, Springer Berlin Heidelberg. 2005.
pp. 54 - 64.

\bibitem{diffserve}
N. Semret, R. R. F. Liao, A. T. Campbell and A. A. Lazar, 
\textit{Pricing, provisioning and peering: dynamic markets for differentiated Internet services and
implications for network interconnections}, in IEEE Journal on Selected Areas in
Communications, vol. 18, no. 12, pp. 2499-2513, Dec. 2000.

\end{thebibliography}


\end{document}

